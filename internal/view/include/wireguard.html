{{ define "content" }}
<div>
    <form action="/wireguard" method="POST" class="config-form" enctype="multipart/form-data" data-turbo-frame="mikrotik-script">
        <div class="form-group">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" value="{{ .FormData.Name }}" required>
        </div>
        <div class="form-group">
            <label for="configFile">WireGuard Configuration File:</label>
            <input type="file" id="configFile" name="configFile" accept=".conf" required>
        </div>
        <div class="form-group">
            <label for="listenPort">Listen Port:</label>
            <input type="number" id="listenPort" name="listenPort" value="{{ .FormData.ListenPort }}" required min="1024" max="65535">
        </div>
        <div class="form-group">
            <label for="configType">Configuration Type:</label>
            <select id="configType" name="configType" required>
                <option value="routing_rule" {{ if eq .FormData.ConfigType "Routing rule" }}selected{{ end }}>Routing rule</option>
                <option value="mangle" {{ if eq .FormData.ConfigType "Mangle" }}selected{{ end }}>Mangle</option>
            </select>
        </div>
        <button type="submit" class="submit-btn">Generate Script</button>
    </form>
    <turbo-frame id="mikrotik-script">
      {{ if .Error }}
      <div class="error-message">{{ .Error }}</div>
      {{ end }}
      {{ if .MikrotikScript }}
      <div class="output-container">
          <div class="script-tabs">
              <button class="tab-button active" onclick="showScript('main')">Configuration Script</button>
              <button class="tab-button" onclick="showScript('reverse')">Reverse Script</button>
          </div>

          <div id="main-script" class="script-content active">
              <h2>Generated Script:</h2>
              <textarea id="scriptOutput" readonly>{{ .MikrotikScript }}</textarea>
              <button id="copyButton" onclick="copyScript('scriptOutput')" class="copy-btn">Copy to Clipboard</button>
          </div>

          <div id="reverse-script" class="script-content">
              <h2>Reverse Script:</h2>
              <p class="script-description">Use this script to remove the WireGuard configuration and restore the original state.</p>
              <textarea id="reverseScriptOutput" readonly>{{ .ReverseScript }}</textarea>
              <button id="copyReverseButton" onclick="copyScript('reverseScriptOutput')" class="copy-btn">Copy to Clipboard</button>
          </div>
      </div>
      <script>
          function showScript(type) {
              document.querySelectorAll('.script-content').forEach(content => {
                  content.classList.remove('active');
              });

              document.querySelectorAll('.tab-button').forEach(tab => {
                  tab.classList.remove('active');
              });

              if (type === 'main') {
                  document.getElementById('main-script').classList.add('active');
                  document.querySelector('[onclick="showScript(\'main\')"]').classList.add('active');
              } else {
                  document.getElementById('reverse-script').classList.add('active');
                  document.querySelector('[onclick="showScript(\'reverse\')"]').classList.add('active');
              }
          }

          function copyScript(textareaId) {
              var scriptOutput = document.getElementById(textareaId);
              scriptOutput.select();
              document.execCommand('copy');
              alert('Script copied to clipboard!');
          }
      </script>
      {{ end }}
    </turbo-frame>
</div>
{{ end }}
